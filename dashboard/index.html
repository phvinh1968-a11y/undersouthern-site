<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
<title>BGM Dashboard</title>
<script>
  emailjs.init("76t6wZsNebhI-PqFv");

  function generatePassword(lengt = 12) {
    const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&*?";
    let pass = "";
    for (let i = 0; i < length; i++) pass += chars.charAt(Math.floor(Math.random() * chars.length));
    return pass;
  }

  function showPage(pageId) {
    ["loginPage", "createPage", "dashboardPage"].forEach(id => document.getElementById(id).style.display = "none");
    document.getElementById(pageId).style.display = "block";
  }

  function createAccount(event) {
    event.preventDefault();
    const email = document.getElementById("createEmail").value;
    const password = generatePassword();

    const existing = JSON.parse(localStorage.getItem("accounts") || "[]");
    if (existing.find(acc => acc.email === email)) {
      alert("Email đã tồn tại! Vui lòng đăng nhập.");
      showPage("loginPage");
      return;
    }

    existing.push({ email, password });
    localStorage.setItem("accounts", JSON.stringify(existing));

    emailjs.send("service_jau0xqb", "template_bgmshorts", { user_email: email, user_password: password })
      .then(() => {
        alert(`Tài khoản tạo thành công! Mật khẩu đã gửi đến ${email}`);
        showPage("loginPage");
      })
      .catch(() => alert("Gửi email thất bại!"));
  }

  function login(event) {
    event.preventDefault();
    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("loginPassword").value;

    const accounts = JSON.parse(localStorage.getItem("accounts") || "[]");
    const found = accounts.find(acc => acc.email === email && acc.password === password);

    if (found) {
      localStorage.setItem("loggedIn", "true");
      localStorage.setItem("loggedEmail", email);
      showDashboard();
    } else alert("Email hoặc mật khẩu không đúng!");
  }

  function showDashboard() {
    document.getElementById("dashboardEmail").innerText = localStorage.getItem("loggedEmail");
    showPage("dashboardPage");
  }

  function logout() {
    localStorage.removeItem("loggedIn");
    localStorage.removeItem("loggedEmail");
    showPage("loginPage");
  }

  window.onload = () => localStorage.getItem("loggedIn") === "true" ? showDashboard() : showPage("loginPage");
</script>
</head>
<body class="bg-[#0F0F0F] flex items-center justify-center h-screen px-4">

<div id="loginPage" class="w-full max-w-md bg-[#1A1A1A] p-8 rounded-2xl shadow-xl border border-gray-800 hidden">
  <h1 class="text-center text-3xl font-semibold text-white mb-6">BGM Dashboard</h1>
  <form class="space-y-5" onsubmit="login(event)">
    <div>
      <label class="text-gray-300 text-sm">Email</label>
      <input id="loginEmail" type="email" required class="w-full mt-1 p-3 rounded-lg bg-[#2A2A2A] border border-gray-700 text-white" placeholder="you@example.com" />
    </div>
    <div>
      <label class="text-gray-300 text-sm">Password</label>
      <input id="loginPassword" type="password" required class="w-full mt-1 p-3 rounded-lg bg-[#2A2A2A] border border-gray-700 text-white" placeholder="••••••••" />
    </div>
    <button type="submit" class="w-full p-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold">Sign In</button>
  </form>
  <p class="text-gray-400 text-center mt-4 text-sm">Don't have an account?
    <button onclick="showPage('createPage')" class="text-blue-400 hover:underline">Create Account</button>
  </p>
</div>

<div id="createPage" class="w-full max-w-md bg-[#1A1A1A] p-8 rounded-2xl shadow-xl border border-gray-800 hidden">
  <h1 class="text-center text-3xl font-semibold text-white mb-6">Create New Account</h1>
  <form class="space-y-5" onsubmit="createAccount(event)">
    <div>
      <label class="text-gray-300 text-sm">Email</label>
      <input id="createEmail" type="email" required class="w-full mt-1 p-3 rounded-lg bg-[#2A2A2A] border border-gray-700 text-white" placeholder="Enter your email" />
    </div>
    <button type="submit" class="w-full p-3 rounded-lg bg-green-600 hover:bg-green-700 text-white font-semibold">Create Account</button>
  </form>
  <p class="text-gray-400 text-center mt-4 text-sm">Already have an account?
    <button onclick="showPage('loginPage')" class="text-blue-400 hover:underline">Login</button>
  </p>
</div>

<div id="dashboardPage" class="w-full max-w-md bg-[#1A1A1A] p-8 rounded-2xl shadow-xl border border-gray-800 text-center hidden">
  <h1 class="text-3xl font-semibold text-white mb-6">Welcome, <span id="dashboardEmail"></span></h1>
  <p class="text-gray-300 mb-6">This is your BGM Dashboard</p>
  <button onclic
