<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <title>BGM Dashboard</title>
  <script>
    (function() {
      emailjs.init("YOUR_PUBLIC_KEY"); // Thay bằng Public Key của bạn
    })();

    function generatePassword(length = 10) {
      const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%&*?";
      let pass = "";
      for (let i = 0; i < length; i++) {
        pass += chars.charAt(Math.floor(Math.random() * chars.length));
      }
      return pass;
    }

    function createAccount(email) {
      const password = generatePassword();
      // Lưu tạm trong localStorage
      localStorage.setItem("accountEmail", email);
      localStorage.setItem("accountPassword", password);

      // Gửi email qua EmailJS
      emailjs.send("YOUR_SERVICE_ID", "YOUR_TEMPLATE_ID", {
        user_email: email,
        user_password: password
      })
      .then(() => alert(`Mật khẩu đã gửi đến email ${email}`))
      .catch((err) => alert("Gửi email thất bại!"));
    }

    function login(event) {
      event.preventDefault();
      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;

      const storedEmail = localStorage.getItem("accountEmail");
      const storedPassword = localStorage.getItem("accountPassword");

      if(email === storedEmail && password === storedPassword) {
        localStorage.setItem("loggedIn", "true");
        localStorage.setItem("loggedEmail", email);
        renderDashboard();
      } else {
        alert("Email hoặc mật khẩu không đúng!");
      }
    }

    function renderDashboard() {
      const email = localStorage.getItem("loggedEmail");
      document.body.innerHTML = `
        <div class="bg-[#0F0F0F] flex items-center justify-center h-screen px-4">
          <div class="w-full max-w-md bg-[#1A1A1A] p-8 rounded-2xl shadow-xl border border-gray-800 text-center">
            <h1 class="text-3xl font-semibold text-white mb-6">Welcome, ${email}</h1>
            <p class="text-gray-300 mb-6">This is your BGM Dashboard</p>
            <button id="logoutBtn" class="w-full p-3 rounded-lg bg-red-600 hover:bg-red-700 text-white font-semibold transition">Logout</button>
          </div>
        </div>
      `;

      document.getElementById("logoutBtn").onclick = () => {
        localStorage.removeItem("loggedIn");
        localStorage.removeItem("loggedEmail");
        location.reload();
      }
    }

    window.onload = () => {
      if(localStorage.getItem("loggedIn") === "true") {
        renderDashboard();
      }
    }
  </script>
</head>
<body class="bg-[#0F0F0F] flex items-center justify-center h-screen px-4">
  
  <div class="w-full max-w-md bg-[#1A1A1A] p-8 rounded-2xl shadow-xl border border-gray-800">
    <h1 class="text-center text-3xl font-semibold text-white mb-6">
      BGM Dashboard
    </h1>

    <form class="space-y-5" onsubmit="login(event)">
      <div>
        <label class="text-gray-300 text-sm">Email</label>
        <input
          id="loginEmail"
          type="email"
          class="w-full mt-1 p-3 rounded-lg bg-[#2A2A2A] border border-gray-700 text-white focus:ring-2 focus:ring-blue-500 outline-none"
          placeholder="you@example.com"
          required
        />
      </div>

      <div>
        <label class="text-gray-300 text-sm">Password</label>
        <input
          id="loginPassword"
          type="password"
          class="w-full mt-1 p-3 rounded-lg bg-[#2A2A2A] border border-gray-700 text-white focus:ring-2 focus:ring-blue-500 outline-none"
          placeholder="••••••••"
          required
        />
      </div>

      <button
        type="submit"
        class="w-full p-3 rounded-lg bg-blue-600 hover:bg-blue-700 text-white font-semibold transition"
      >
        Sign In
      </button>
    </form>

    <p class="text-gray-400 text-center mt-4 text-sm">
      Don't have an account? 
      <button onclick="createAccount(prompt('Enter your email to create account:'))" class="text-blue-400 hover:underline">Create one</button>
    </p>
    
  </div>

</body>
</html>
